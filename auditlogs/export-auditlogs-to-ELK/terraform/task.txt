0 docker файл выложен в https://console.cloud.yandex.ru/folders/b1g4n62gio32v96mdvrb/container-registry/crpjfmfou6gflobbfvfv 

1 презеквизиты

1) Пользователь создал аудит трейл руками и настроил передачу трейла в бакет
2) Пользователь создал сервисный аккаунт и дал ему роль storage.editor ( уточним набор ролей)
3) Пользователь создал сеть и подсети где будет находится эластик и виртулака ( можно в пример создать сеть самому)


2 Модуль с эластик

входы
- подсети в которых создавать эластик 
- id фолдера

что он делает

- создает эластик в требуемой конфигурации ( с каким то дефолттом - basic лицензии)

выходы

- адрес эластика вида https://c-<идентификатор кластера Elasticsearch>.rw.mdb.yandexcloud.net
- учетка для подлючения

3 Модуль для синкалки

Входа
- адрес и учетка эластика 
- имя бакета
- имя sa 
- id фолдера
- id сабнета

что он делает

- создает пару ключей в формате AWS и SA
- создает docker compose файл и прописывает там все переменные окружения ( с помощью фунции template) и там же выставляет переменную окружения для sleep выставляем 300 секунд
- создает COI и в его метаданные подставляет compose файл ( network-ssd диск в 100 Гб , 4 vCPU 4 GB ram)




Леше todo - это пример в терраформе описать

1) Создаем бакет , создаем sa с роями и создаем сеть
2) С помощью модуля 1 создаем эластик 
3) С помощью модуля 2 ( его входы это выходы модуля 1) создаем COI